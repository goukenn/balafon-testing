<?php
// + | --------------------------------------------------------------------
// + | generate a css documentation 
// + |
// @command: balafon --run .test/css/get_css_documentation.php
use IGK\Helper\IO;
use IGK\System\Console\Logger;
use IGK\System\Html\HtmlReader;
use IGK\System\Html\HtmlRenderer;
use IGK\System\Text\RegexMatcherContainer;
($file = igk_getv($params, 0)) ?? igk_die("output file");
IO::CreateDir(dirname($file));
$s = <<<EFO
zoom,z-index,y,x,writing-mode,word-wrap,word-spacing,word-break,will-change,width,white-space-collapse,white-space,webkit-user-select,webkit-transition-timing-function,webkit-transition-property,webkit-transition-duration,webkit-transition-delay,webkit-transition,webkit-transform-style,webkit-transform-origin,webkit-transform,webkit-text-stroke-width,webkit-text-stroke-color,webkit-text-stroke,webkit-text-size-adjust,webkit-text-security,webkit-text-fill-color,webkit-perspective-origin,webkit-perspective,webkit-order,webkit-mask-size,webkit-mask-repeat,webkit-mask-position-y,webkit-mask-position-x,webkit-mask-position,webkit-mask-origin,webkit-mask-image,webkit-mask-composite,webkit-mask-clip,webkit-mask,webkit-line-clamp,webkit-justify-content,webkit-font-smoothing,webkit-font-feature-settings,webkit-flex-wrap,webkit-flex-shrink,webkit-flex-grow,webkit-flex-flow,webkit-flex-direction,webkit-flex-basis,webkit-flex,webkit-filter,webkit-clip-path,webkit-box-sizing,webkit-box-shadow,webkit-box-pack,webkit-box-orient,webkit-box-ordinal-group,webkit-box-flex,webkit-box-direction,webkit-box-align,webkit-border-top-right-radius,webkit-border-top-left-radius,webkit-border-radius,webkit-border-image,webkit-border-bottom-right-radius,webkit-border-bottom-left-radius,webkit-background-size,webkit-background-origin,webkit-background-clip,webkit-backface-visibility,webkit-appearance,webkit-animation-timing-function,webkit-animation-play-state,webkit-animation-name,webkit-animation-iteration-count,webkit-animation-fill-mode,webkit-animation-duration,webkit-animation-direction,webkit-animation-delay,webkit-animation,webkit-align-self,webkit-align-items,webkit-align-content,visibility,vertical-align,vector-effect,user-select,unicode-bidi,translate,transition-timing-function,transition-property,transition-duration,transition-delay,transition-behavior,transition,transform-style,transform-origin,transform-box,transform,touch-action,top,text-wrap-style,text-wrap-mode,text-wrap,text-underline-position,text-underline-offset,text-transform,text-shadow,text-rendering,text-overflow,text-orientation,text-justify,text-indent,text-emphasis-style,text-emphasis-position,text-emphasis-color,text-emphasis,text-decoration-thickness,text-decoration-style,text-decoration-skip-ink,text-decoration-line,text-decoration-color,text-decoration,text-combine-upright,text-anchor,text-align-last,text-align,table-layout,tab-size,stroke-width,stroke-opacity,stroke-miterlimit,stroke-linejoin,stroke-linecap,stroke-dashoffset,stroke-dasharray,stroke,stop-opacity,stop-color,shape-rendering,shape-outside,shape-margin,shape-image-threshold,scrollbar-width,scrollbar-gutter,scrollbar-color,scroll-snap-type,scroll-snap-stop,scroll-snap-align,scroll-padding-top,scroll-padding-right,scroll-padding-left,scroll-padding-inline-start,scroll-padding-inline-end,scroll-padding-inline,scroll-padding-bottom,scroll-padding-block-start,scroll-padding-block-end,scroll-padding-block,scroll-padding,scroll-margin-top,scroll-margin-right,scroll-margin-left,scroll-margin-inline-start,scroll-margin-inline-end,scroll-margin-inline,scroll-margin-bottom,scroll-margin-block-start,scroll-margin-block-end,scroll-margin-block,scroll-margin,scroll-behavior,scale,ry,rx,ruby-position,ruby-align,row-gap,rotate,right,resize,r,quotes,print-color-adjust,position,pointer-events,place-self,place-items,place-content,perspective-origin,perspective,paint-order,page-break-inside,page-break-before,page-break-after,page,padding-top,padding-right,padding-left,padding-inline-start,padding-inline-end,padding-inline,padding-bottom,padding-block-start,padding-block-end,padding-block,padding,overscroll-behavior-y,overscroll-behavior-x,overscroll-behavior-inline,overscroll-behavior-block,overscroll-behavior,overflow-y,overflow-x,overflow-wrap,overflow-inline,overflow-clip-margin,overflow-block,overflow-anchor,overflow,outline-width,outline-style,outline-offset,outline-color,outline,order,opacity,offset-rotate,offset-position,offset-path,offset-distance,offset-anchor,offset,object-position,object-fit,moz-window-dragging,moz-user-select,moz-transform-style,moz-transform-origin,moz-transform,moz-text-size-adjust,moz-tab-size,moz-perspective-origin,moz-perspective,moz-padding-start,moz-padding-end,moz-osx-font-smoothing,moz-orient,moz-margin-start,moz-margin-end,moz-hyphens,moz-force-broken-image-icon,moz-font-language-override,moz-font-feature-settings,moz-float-edge,moz-box-sizing,moz-box-pack,moz-box-orient,moz-box-ordinal-group,moz-box-flex,moz-box-direction,moz-box-align,moz-border-start-width,moz-border-start-style,moz-border-start-color,moz-border-start,moz-border-image,moz-border-end-width,moz-border-end-style,moz-border-end-color,moz-border-end,moz-backface-visibility,moz-appearance,moz-animation-timing-function,moz-animation-play-state,moz-animation-name,moz-animation-iteration-count,moz-animation-fill-mode,moz-animation-duration,moz-animation-direction,moz-animation-delay,moz-animation,mix-blend-mode,min-width,min-inline-size,min-height,min-block-size,max-width,max-inline-size,max-height,max-block-size,math-style,math-depth,mask-type,mask-size,mask-repeat,mask-position-y,mask-position-x,mask-position,mask-origin,mask-mode,mask-image,mask-composite,mask-clip,mask,marker-start,marker-mid,marker-end,marker,margin-top,margin-right,margin-left,margin-inline-start,margin-inline-end,margin-inline,margin-bottom,margin-block-start,margin-block-end,margin-block,margin,list-style-type,list-style-position,list-style-image,list-style,line-height,line-break,lighting-color,letter-spacing,left,justify-self,justify-items,justify-content,isolation,inset-inline-start,inset-inline-end,inset-inline,inset-block-start,inset-block-end,inset-block,inset,inline-size,ime-mode,image-rendering,image-orientation,hyphens,hyphenate-character,height,grid-template-rows,grid-template-columns,grid-template-areas,grid-template,grid-row-start,grid-row-gap,grid-row-end,grid-row,grid-gap,grid-column-start,grid-column-gap,grid-column-end,grid-column,grid-auto-rows,grid-auto-flow,grid-auto-columns,grid-area,grid,gap,forced-color-adjust,font-weight,font-variation-settings,font-variant-position,font-variant-numeric,font-variant-ligatures,font-variant-east-asian,font-variant-caps,font-variant-alternates,font-variant,font-synthesis-weight,font-synthesis-style,font-synthesis-small-caps,font-synthesis-position,font-synthesis,font-style,font-stretch,font-size-adjust,font-size,font-palette,font-optical-sizing,font-language-override,font-kerning,font-feature-settings,font-family,font,flood-opacity,flood-color,float,flex-wrap,flex-shrink,flex-grow,flex-flow,flex-direction,flex-basis,flex,filter,fill-rule,fill-opacity,fill,empty-cells,dominant-baseline,display,direction,d,cy,cx,cursor,css-float,counter-set,counter-reset,counter-increment,content-visibility,content,container-type,container-name,container,contain-intrinsic-width,contain-intrinsic-size,contain-intrinsic-inline-size,contain-intrinsic-height,contain-intrinsic-block-size,contain,columns,column-width,column-span,column-rule-width,column-rule-style,column-rule-color,column-rule,column-gap,column-fill,column-count,color-scheme,color-interpolation-filters,color-interpolation,color-adjust,color,clip-rule,clip-path,clip,clear,caret-color,caption-side,break-inside,break-before,break-after,box-sizing,box-shadow,box-decoration-break,bottom,border-width,border-top-width,border-top-style,border-top-right-radius,border-top-left-radius,border-top-color,border-top,border-style,border-start-start-radius,border-start-end-radius,border-spacing,border-right-width,border-right-style,border-right-color,border-right,border-radius,border-left-width,border-left-style,border-left-color,border-left,border-inline-width,border-inline-style,border-inline-start-width,border-inline-start-style,border-inline-start-color,border-inline-start,border-inline-end-width,border-inline-end-style,border-inline-end-color,border-inline-end,border-inline-color,border-inline,border-image-width,border-image-source,border-image-slice,border-image-repeat,border-image-outset,border-image,border-end-start-radius,border-end-end-radius,border-color,border-collapse,border-bottom-width,border-bottom-style,border-bottom-right-radius,border-bottom-left-radius,border-bottom-color,border-bottom,border-block-width,border-block-style,border-block-start-width,border-block-start-style,border-block-start-color,border-block-start,border-block-end-width,border-block-end-style,border-block-end-color,border-block-end,border-block-color,border-block,border,block-size,baseline-source,background-size,background-repeat,background-position-y,background-position-x,background-position,background-origin,background-image,background-color,background-clip,background-blend-mode,background-attachment,background,backface-visibility,backdrop-filter,aspect-ratio,appearance,animation-timing-function,animation-play-state,animation-name,animation-iteration-count,animation-fill-mode,animation-duration,animation-direction,animation-delay,animation-composition,animation,all,align-self,align-items,align-content,accent-color,-webkit-user-select,-webkit-transition-timing-function,-webkit-transition-property,-webkit-transition-duration,-webkit-transition-delay,-webkit-transition,-webkit-transform-style,-webkit-transform-origin,-webkit-transform,-webkit-text-stroke-width,-webkit-text-stroke-color,-webkit-text-stroke,-webkit-text-size-adjust,-webkit-text-security,-webkit-text-fill-color,-webkit-perspective-origin,-webkit-perspective,-webkit-order,-webkit-mask-size,-webkit-mask-repeat,-webkit-mask-position-y,-webkit-mask-position-x,-webkit-mask-position,-webkit-mask-origin,-webkit-mask-image,-webkit-mask-composite,-webkit-mask-clip,-webkit-mask,-webkit-line-clamp,-webkit-justify-content,-webkit-font-smoothing,-webkit-font-feature-settings,-webkit-flex-wrap,-webkit-flex-shrink,-webkit-flex-grow,-webkit-flex-flow,-webkit-flex-direction,-webkit-flex-basis,-webkit-flex,-webkit-filter,-webkit-clip-path,-webkit-box-sizing,-webkit-box-shadow,-webkit-box-pack,-webkit-box-orient,-webkit-box-ordinal-group,-webkit-box-flex,-webkit-box-direction,-webkit-box-align,-webkit-border-top-right-radius,-webkit-border-top-left-radius,-webkit-border-radius,-webkit-border-image,-webkit-border-bottom-right-radius,-webkit-border-bottom-left-radius,-webkit-background-size,-webkit-background-origin,-webkit-background-clip,-webkit-backface-visibility,-webkit-appearance,-webkit-animation-timing-function,-webkit-animation-play-state,-webkit-animation-name,-webkit-animation-iteration-count,-webkit-animation-fill-mode,-webkit-animation-duration,-webkit-animation-direction,-webkit-animation-delay,-webkit-animation,-webkit-align-self,-webkit-align-items,-webkit-align-content,-moz-window-dragging,-moz-user-select,-moz-transform-style,-moz-transform-origin,-moz-transform,-moz-text-size-adjust,-moz-tab-size,-moz-perspective-origin,-moz-perspective,-moz-padding-start,-moz-padding-end,-moz-osx-font-smoothing,-moz-orient,-moz-margin-start,-moz-margin-end,-moz-hyphens,-moz-force-broken-image-icon,-moz-font-language-override,-moz-font-feature-settings,-moz-float-edge,-moz-box-sizing,-moz-box-pack,-moz-box-orient,-moz-box-ordinal-group,-moz-box-flex,-moz-box-direction,-moz-box-align,-moz-border-start-width,-moz-border-start-style,-moz-border-start-color,-moz-border-start,-moz-border-image,-moz-border-end-width,-moz-border-end-style,-moz-border-end-color,-moz-border-end,-moz-backface-visibility,-moz-appearance,-moz-animation-timing-function,-moz-animation-play-state,-moz-animation-name,-moz-animation-iteration-count,-moz-animation-fill-mode,-moz-animation-duration,-moz-animation-direction,-moz-animation-delay,-moz-animation 
EFO;
$tab = array_unique(explode(',', $s));
sort($tab);
$tab = array_filter($tab, function ($k) {
    return !preg_match("/^((-)?moz|(-)?webkit)/", $k);
});
$tab = array_fill_keys($tab, []);
$container = new RegexMatcherContainer;
$container->begin("<body", "\<\/body>", "home");
$TC = count($tab);
$tc = 1;
// $hfile = fopen($file, "r+");
foreach ($tab as $k => $v) {
    Logger::info('load '.$k . " ".$tc." / ".$TC);
    $tc++;
    $uri = 'https://developer.mozilla.org/en-US/docs/Web/CSS/' . $k;
    $found = false;
    if ($c = igk_curl_post_uri($uri)) {
        $Ttab = & $tab;
        try {
            $container->treat($c, function ($s) use ($k, &$found, & $Ttab) {
                $h = igk_create_node('div');
                $h->load($s->value);
                $tab = $h->getElementsByTagName("div");
                while (count($tab) > 0) {
                    $q = array_shift($tab);
                    if ($q['class'] == 'section-content') {
                        $txt = HtmlRenderer::GetInneText($q);
                        $txt = preg_replace("/\\b{$k}\\b/", "`{$k}`", $txt);
                        $Ttab[$k][] = $txt;
                        $found = true;
                        break;
                    }
                }
            });
        } catch (Exception $ex) {
            igk_ilog('missing or loading content failled ' . $k);
            Logger::danger("failed: ".$k);
            $container->resetTreatment();
        }
    }
    if (!$found) {
        $tab[$k][] = '*****************************';
    }
    $tab[$k][] = '- [doc](' . $uri . ')';
}
$l = json_encode($tab, JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES);
igk_io_w2file($file, $l);
Logger::success("write to : ".$file);
igk_exit();